QAN2P34 ;ALB/DRP - Set OUT OF ORDER field for old QAN options ;07/17/2018  13:00
 ;;2.0;Incident Reporting;**34**;08/07/1992;Build 6
 ;Reference to XPDMENU supported by ICR 1157
 Q
 ;
MAIN(QAN) ; Step through options, pull IEN from B index and update
 ;QAN IS THE MENU RESTORE FLAG : 1=restore, anything else will place out of order
 N DA,DIE,DR,DO,QANSOPT,QANSD0,QANMSG,QANI,QANTXT  K X,Y
 S QAN=$G(QAN),QANTXT=$S(QAN=1:"@",1:"Disabled-USE Joint Patient Safety Reporting-JPSR")
 F QANI=1:1  S QANSOPT=$P($T(OPTS+QANI^QAN2P34),";",3) Q:QANSOPT=""  D
 . S QANSD0=$O(^DIC(19,"B",QANSOPT,0)) I QANSD0="" S QANMSG="OPTION "_QANSOPT_" NOT FOUND" D EN^DDIOL(QANMSG) Q
 . Q:$P($G(^DIC(19,QANSD0,0)),"^")'=QANSOPT
 . S QANMSG="SETTING "_QANSOPT_" TO "_$S(QAN=1:"ACTIVE...",1:"OUT OF ORDER...")
 . D EN^DDIOL(QANMSG),OUT^XPDMENU(QANSOPT,QANTXT)
 .Q
 D CLEAN^DILF
 Q
OPTS ; Options to disable
 ;;QAN AUTO E-MAIL BRIEF
 ;;QAN AUTO E-MAIL DELETE
 ;;QAN AUTO E-MAIL FULL
 ;;QAN BRIEF EDIT
 ;;QAN DBASE INTEGRITY CHECKER
 ;;QAN EARLY WARNING SYSTEM AUTO
 ;;QAN EARLY WARNING SYSTEM MAN
 ;;QAN INCIDENT FOLLOW-UP
 ;;QAN INCIDENT LOCATION
 ;;QAN INCIDENT MAIL TO REGION
 ;;QAN INCIDENT QUICK
 ;;QAN INCIDENT REGION STATUS
 ;;QAN INCIDENT REPORT
 ;;QAN INCIDENT STATUS ENTER/EDIT
 ;;QAN INCIDENT SUMMARY REGION
 ;;QAN INCIDENT WORKSHEET
 ;;QAN PATIENT MANIPULATION
 ;;QAN PATIENT/INCIDENT VIEW
 ;;QAN RECORD MANIPULATION
 ;;QAN SITE PARAMETERS ENTER/EDIT
 ;;QAN FR ENTER/EDIT
 ;;QAN FR PRINT
 ;;QAN BOI ENTER/EDIT
 ;;QANSERV
 ;;QAN FR DELETE
 ;;QAN MANUAL FORM UPDATE
 ;;QAN MANUAL FORM NOTIFICATION
 ;;QAN IR MANUAL UPDATE
 ;;QAN IR MANUAL NOTIFICATION
 ;;QANERC
 ;;QAN TEST
 ;;QAN TRANSMIT
 ;;QAN PRINT IR
 Q
